<?php

class UserController extends CController
{
    // ???????? ?? ?????????. ??????? ?????? ?????????????.
    public function actionIndex()
    {
        // ???????? ?????? ???? ?????????????????? ?????????????...
        $users = User::model()->findAll();

        // ...? ??????? ??
        $this->render('users_list', array('users'=>$users));
    }

    // ???????? ???????????
    public function actionSignup()
    {
        // ??????? ?????? ? ??????? ??, ??? ???????????? ???????? ???????????
        $user = new User(User::SCENARIO_SIGNUP);

        // ???? ?????? ?????? ??? ??????????
        if(isset($_POST['User']))
        {
            // ?????????? ???????????? ???????? ?????????
            $user->attributes = $_POST['User'];

            // ???????? ??????
            if($user->validate())
            {
                // ????????? ?????????? ??????
                // false ????? ??? ????, ????? ?? ??????????? ????????? ????????
                $user->save(false);

                // ????????????? ?? ?????? ?????????????????? ?????????????
                $this->redirect($this->createUrl('user/'));
            }
        }

        // ??????? ?????
        $this->render('form_signup', array('form'=>$user));
    }
} 